<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:mmd="clr-namespace:MiniMikuDanceMaui"
             x:Class="MiniMikuDanceMaui.TimeLineView"
             BackgroundColor="{StaticResource BackgroundColor}">
    <Grid ColumnDefinitions="1*,3*">
        <Grid.RowDefinitions>
            <RowDefinition Height="{StaticResource RowHeight}" />
            <RowDefinition Height="64" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <!-- 操作バー -->
        <HorizontalStackLayout Spacing="8" Padding="8" HeightRequest="{StaticResource RowHeight}">
            <Button Text="Add Bone" x:Name="AddBoneButton" Style="{StaticResource TimelineButtonStyle}" HorizontalOptions="StartAndExpand" />
            <Button Text="Add Key" x:Name="AddKeyButton" Style="{StaticResource TimelineButtonStyle}" HorizontalOptions="End" />
            <Button Text="Edit Key" x:Name="EditKeyButton" Style="{StaticResource TimelineButtonStyle}" HorizontalOptions="End" />
            <Button Text="Delete Key" x:Name="DeleteKeyButton" Style="{StaticResource TimelineButtonStyle}" HorizontalOptions="End" />
        </HorizontalStackLayout>
        <Button Text="×" x:Name="CloseButton" Grid.Column="1" HorizontalOptions="End" VerticalOptions="Center" Clicked="OnCloseClicked" />
        <!-- トランスポートとフレームヘッダー -->
        <Grid Row="1" ColumnDefinitions="1*,5*" Padding="8" HeightRequest="64" VerticalOptions="Center" Grid.ColumnSpan="2">
            <HorizontalStackLayout Spacing="10">
                <Button Text="▶" x:Name="PlayButton" Style="{StaticResource TimelineButtonStyle}" />
                <Button Text="Ⅱ" x:Name="PauseButton" Style="{StaticResource TimelineButtonStyle}" />
                <Button Text="■" x:Name="StopButton" Style="{StaticResource TimelineButtonStyle}" />
            </HorizontalStackLayout>
            <BoxView Grid.Column="1" Color="Transparent" />
        </Grid>
        <!-- ボーンリストとキーグリッド -->
        <CollectionView x:Name="BoneList" Grid.Row="2" ItemSizingStrategy="MeasureAllItems" Scrolled="OnBoneListScrolled">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Label Text="{Binding}" TextColor="{StaticResource TextColor}" HeightRequest="{StaticResource RowHeight}" VerticalTextAlignment="Center" />
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
        <ScrollView Grid.Row="2" Grid.Column="1" x:Name="GridScroll" Orientation="Both" Scrolled="OnGridScrolled">
            <mmd:TimelineGridView x:Name="GridView" x:FieldModifier="public" RowHeight="{StaticResource RowHeight}" />
        </ScrollView>
    </Grid>
</ContentView>
