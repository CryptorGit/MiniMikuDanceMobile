<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:skia="clr-namespace:SkiaSharp.Views.Maui.Controls;assembly=SkiaSharp.Views.Maui.Controls"
             xmlns:local="clr-namespace:MiniMikuDanceMaui"
             x:Class="MiniMikuDanceMaui.TimelineView"
             Loaded="OnTimelineViewLoaded"
             BackgroundColor="{StaticResource BackgroundColor}">
    <Grid RowDefinitions="Auto,Auto,*,Auto" RowSpacing="4" Padding="4">
        <!-- Operation buttons -->
        <HorizontalStackLayout Grid.Row="0" Spacing="6" HorizontalOptions="Start">
            <Button Text="Add Key"    Clicked="OnAddKeyClicked" />
            <Button Text="Edit Key"   Clicked="OnEditKeyClicked" />
            <Button Text="Delete Key" Clicked="OnDeleteKeyClicked" />
        </HorizontalStackLayout>

        <!-- Playback and Frame controls -->
        <Grid Grid.Row="1" ColumnDefinitions="Auto,*,Auto">
            <HorizontalStackLayout Grid.Column="0" Spacing="6">
                <Button Text="▶" Clicked="OnPlayClicked" />
                <Button Text="❚❚" Clicked="OnPauseClicked" />
                <Button Text="■" Clicked="OnStopClicked" />
            </HorizontalStackLayout>

            <HorizontalStackLayout Grid.Column="2" Spacing="6">
                <Button Text="|&lt;" Clicked="OnFrameToStartClicked" />
                <Button Text="&lt;"  Clicked="OnFrameMinusOneClicked" />
                <Entry x:Name="CurrentFrameEntry" WidthRequest="60" Text="0" Keyboard="Numeric" />
                <Button Text=">"  Clicked="OnFramePlusOneClicked" />
                <Button Text=">|" Clicked="OnFrameToEndClicked" />
            </HorizontalStackLayout>
        </Grid>

        <!-- Timeline Area -->
        <Grid Grid.Row="2" ColumnDefinitions="90,*" RowDefinitions="Auto,*">
            <!-- Frame number header -->
            <Label Grid.Row="0" Grid.Column="0" Text="" BackgroundColor="{StaticResource BackgroundColor}" />
            <ScrollView x:Name="FrameHeaderScroll"
                        Grid.Row="0" Grid.Column="1"
                        Orientation="Horizontal"
                        HorizontalOptions="FillAndExpand"
                        VerticalOptions="Start"
                        BackgroundColor="{StaticResource BackgroundColor}">
                <skia:SKCanvasView x:Name="HeaderCanvas"
                                   HeightRequest="30"
                                   PaintSurface="OnHeaderPaintSurface" />
            </ScrollView>
            <!-- Left Panel (Bone Names) -->
            <ScrollView Grid.Column="0" Grid.Row="1" VerticalOptions="FillAndExpand" VerticalScrollBarVisibility="Never" x:Name="BoneNameScrollView">
                <Grid x:Name="BoneNameContentGrid">
                    <skia:SKCanvasView x:Name="BoneNameCanvas"
                                       PaintSurface="OnBoneNamePaintSurface"
                                       HorizontalOptions="Start"
                                       VerticalOptions="Start" />
                </Grid>
            </ScrollView>

            <!-- Right Panel (Timeline Grid and Keyframes) -->
            <ScrollView Grid.Column="1" Grid.Row="1"
                        Orientation="Both"
                        VerticalScrollBarVisibility="Always"
                        HorizontalScrollBarVisibility="Always"
                        VerticalOptions="FillAndExpand"
                        x:Name="TimelineContentScrollView">
                <Grid x:Name="TimelineContentGrid"
                      RowDefinitions="*,Auto">
                    <skia:SKCanvasView x:Name="TimelineContentCanvas"
                                       PaintSurface="OnTimelineContentPaintSurface"
                                       HorizontalOptions="Start"
                                       Grid.Row="0" />
                    <skia:SKCanvasView x:Name="BoneKeyInputKeyCanvas"
                                       PaintSurface="OnBoneKeyInputKeyPaintSurface"
                                       HeightRequest="50"
                                       HorizontalOptions="End"
                                       Grid.Row="1" />
                </Grid>
            </ScrollView>
        </Grid>

        </Grid>
</ContentView>
