# MiniMikuDance

MiniMikuDance は、スマートフォン上で MMD 互換モデルを再生・撮影できるモバイル向けアプリです。姿勢推定や録画処理も端末で完結し、Unity を使用せずに C# と OpenTK で実装されています。
実行には `ffmpeg` コマンドが必要です。Android 環境では別途バイナリを用意し PATH に追加するかアプリに同梱してください。
**注意: `global.json` の SDK バージョンは `9.0.301` から変更しないこと。**

## ポーズファイルの読み込み

メニューの **File › Adapt Pose** を選択すると、`*.csv` 形式の角度データを読み込んで現在のモデルに適用できます。CSV には SMPL 形式の軸回転ベクトルが記録されており、アプリ側で VRM 標準ボーン用の角度に変換してからタイムラインへ反映します。タイムラインの既定最大フレーム数は 60 ですが、読み込んだモーションが 60 フレームを超える場合は自動的に上限が拡張されます。

## Timeline の既知の課題

*   **横スクロール時のバウンス挙動**: Android 環境において、横スクロールの終端でコンテンツが「伸びる」ような挙動が観測されます。これは、標準的なオーバースクロール効果とは異なる、レイアウトや描画の特性に起因する可能性があります。
## 姿勢適用実装のポイント

* VRM 取り込み後、`ModelImporter` は標準ボーン名と実ノード番号の対応を `ModelData.HumanoidBones` 辞書に保持します。姿勢を適用するときはこの辞書、あるいは `HumanoidBoneList[i].Index` を用いて実際のインデックスを取得してください。
* `FindIndex` で求めたリスト上の順序をそのまま `VrmRenderer` に渡すと誤ったボーンが変化します。必ず上記のインデックス変換を挟みます。
* `TimelineView` や各種パネルからボーンを操作する実装では、共通メソッド化してインデックス変換を行うとコードの重複を防げます。
* 今後姿勢編集機能を拡張する際も、この仕組みを基に実装するとスムーズです。
