# MiniMikuDance

MiniMikuDance は、スマートフォン上で PMX 形式の MMD 互換モデルを再生・撮影できるモバイル向けアプリです。VRM などの他形式はサポートせず、PMX に特化しています。姿勢推定や録画処理も端末で完結し、Unity を使用せずに C# と OpenTK で実装されています。
実行には `ffmpeg` コマンドが必要です。Android 環境では別途バイナリを用意し PATH に追加するかアプリに同梱してください。
**注意: `global.json` の SDK バージョンは `9.0.301` から変更しないこと。**


## 目次
- 目的 / ビジョン
- スコープ
- ターゲット環境
- 主要機能
- ユーザー体験（UX）方針
- データ/ファイル形式
- 描画/技術スタック
- 共有/配布ポリシー
- データフロー
- 設定/プロジェクト構成
- ビルド/配布
- 品質/テスト
- ロードマップ
- 用語集
- 更新履歴

---

## 目的 / ビジョン
- スマホ上で **直感的にダンスモーションを作れる** MMD系エディタ。
- キー打ち無しで、**ハンドル** + **ノード/ステート遷移**で制作する。

## スコープ
- **PMXのみ** のモデル読み込み・表示
- トラッカー不要のハンドルによるポーズ作成
- **ノード/ステートベース** のモーション遷移（タイムライン無し）
- **モーション入力のみ可**（ファイル出力は不可）
- モーションの**共有は専用SNS的プラットフォーム**への投稿のみ

## ターゲット環境
- **モバイル**: iOS / Android（MAUI + OpenTK 予定）
- **入力**: **タッチのみ**（マルチタッチジェスチャ対応予定）
- **最小スペック目安**: TBA

## 主要機能
- [ ] **PMX** の読み込み（テクスチャ自動解決、スケール調整）
- [ ] **ハンドル**でのポーズ編集（頭/両手/腰/胸/両足/両膝/両肘）
- [ ] **ノード/ステート遷移**エディタ（Blueprint 風の簡易グラフ）
- [ ] **モーション入力**（例：VMD/CSV/独自フォーマット ※TBD）
- [ ] **共有**：アプリから専用プラットフォームへ投稿（ローカル出力なし）

## ユーザー体験（UX）方針
- **自由視点カメラ**
- **FPD（Focus-Perpendicular Drag）**：カメラ焦点 F と選択ゴール G を結ぶ直線を法線 n とする平面 Π 上でドラッグ
- **タップピッキング**：二段階（2D候補→3D交差＋遮蔽）で誤選択を抑制
- **最小タップ数**でノード作成・遷移設定・再生確認

## データ/ファイル形式
- **モデル入力**: `.pmx`
- **テクスチャ**: `tex/`, `spa/` 等（詳細TBD）
- **モーション入力**: `.vmd` / `.csv` / 独自（TBD）
- **モーション出力**: **なし**（端末内保存不可）

## 描画/技術スタック
- **UI**: .NET MAUI
- **描画**: OpenTK（GL ES 3.x）
- **シェーダ**: トゥーン（基本）/ PBR（TBD）
- **アセット管理**: 非同期ロード、GPUメモリ最適化（TBD）

## 共有/配布ポリシー
- **出力は専用SNS的プラットフォームのみ**  
  - アプリから直接投稿（名称/API仕様はTBD）
  - 端末内ファイル出力は不可
  - 閲覧・再生・配布はプラットフォーム上で実施

## データフロー
```text
[PMX Model] --> [PMX Importer] --> [Scene/Bones]
[Handles] <--> [Solver] <--> [Rig] --> [Node/State Graph Playback]
[Motion Files (Import Only)] --> [Graph Nodes / States]
[Share] --> [Dedicated Motion Platform (Only)]
